{% extends "base.html" %}
{% block content %}
<h1>Forums</h1>

<!-- Category filter dropdown -->
<form method="get" action="{{ url_for('main.forums') }}">
  <label for="cat">Filter by category:</label>
  <select name="category" id="cat" onchange="this.form.submit()">
    <option value="">All</option>
    {% for cat in categories %}
      <option value="{{ cat }}" {% if request.args.get('category') == cat %}selected{% endif %}>{{ cat }}</option>
    {% endfor %}
  </select>
</form>

<a href="{{ url_for('main.create_thread') }}">âž• Create New Thread</a>
<div>
  {% for forum in forums %}
    <div class="thread-block">
      <a href="{{ url_for('main.thread', thread_id=forum.id) }}">
        <strong>[{{ forum.category }}]</strong> {{ forum.title }}
      </a>
      {% if forum.is_sticky %}
        <span style="color:green;font-weight:bold;margin-left:4px;">[Pinned]</span>
      {% endif %}
      <span style="float:right;">
        {% if session.is_admin %}
          <a href="{{ url_for('main.delete_thread', thread_id=forum.id) }}"
             style="color:red;"
             onclick="return confirm('Delete this thread and ALL posts?');">[delete]</a>
        {% endif %}
        <span style="color:#888; margin-left:10px;">{{ forum.created_at }}</span>
      </span>
      <br>
      <span style="color: #555;">{{ forum.description }}</span>
    </div>
  {% else %}
    <div class="info">No threads yet.</div>
  {% endfor %}
</div>
{% endblock %}